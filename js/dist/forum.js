module.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=18)}([function(t,e){t.exports=flarum.core.compat.app},function(t,e){t.exports=flarum.core.compat.extend},function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return r}))},function(t,e){t.exports=flarum.core.compat["components/Button"]},,function(t,e,n){"use strict";function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}n.d(e,"a",(function(){return r}))},function(t,e){t.exports=flarum.core.compat.Component},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}n.d(e,"a",(function(){return o}))},,function(t,e){t.exports=flarum.core.compat["components/CommentPost"]},function(t,e){t.exports=flarum.core.compat["components/TextEditor"]},function(t,e){t.exports=flarum.core.compat["components/Dropdown"]},function(t,e){t.exports=flarum.core.compat["utils/ItemList"]},function(t,e){t.exports=flarum.core.compat["helpers/icon"]},,,,,function(t,e,n){"use strict";n.r(e);var r=n(1),o=n(0),i=n.n(o),a=n(9),l=n.n(a),u=n(10),c=n.n(u),s=(n(7),n(2),n(5)),f=n(6),m=n.n(f),h=n(11),p=n.n(h),d=n(3),b=n.n(d),x=n(12),v=n.n(x),g=n(13),E=n.n(g);function S(){return(S=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}var y=null;function R(t){return t.trim().split("\n").length>1}function O(t,e){return Array(e+1).join(t)}function T(t,e){for(var n=e;t[n]&&null!=t[n-1]&&!t[n-1].match(/\s/);)n--;return n}function w(t,e,n){for(var r=e,o=n?/\n/:/\s/;t[r]&&!t[r].match(o);)r++;return r}function j(t){var e,n,r=t.value.slice(0,t.selectionStart),o=t.value.slice(t.selectionEnd),i=r.match(/\n*$/),a=o.match(/^\n*/),l=i?i[0].length:0,u=a?a[0].length:0;return r.match(/\S/)&&l<2&&(e=O("\n",2-l)),o.match(/\S/)&&u<2&&(n=O("\n",2-u)),null==e&&(e=""),null==n&&(n=""),{newlinesToAppend:e,newlinesToPrepend:n}}var M=function(t,e){var n=e.prefix,r=e.suffix,o=e.blockPrefix,i=e.blockSuffix,a=e.replaceNext,l=e.prefixSpace,u=e.scanFor,c=e.surroundWithNewlines,s=t.selectionStart,f=t.selectionEnd,m=t.value.slice(t.selectionStart,t.selectionEnd),h=R(m)&&o.length>0?o+"\n":n,p=R(m)&&i.length>0?"\n"+i:r;if(l){var d=t.value[t.selectionStart-1];0===t.selectionStart||null==d||d.match(/\s/)||(h=" "+h)}m=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.selectionStart===t.selectionEnd)t.selectionStart=T(t.value,t.selectionStart),t.selectionEnd=w(t.value,t.selectionEnd,r);else{var o=t.selectionStart-e.length,i=t.selectionEnd+n.length,a=t.value.slice(o,t.selectionStart)===e,l=t.value.slice(t.selectionEnd,i)===n;a&&l&&(t.selectionStart=o,t.selectionEnd=i)}return t.value.slice(t.selectionStart,t.selectionEnd)}(t,h,p,e.multiline);var b=t.selectionStart,x=t.selectionEnd,v=a.length>0&&p.indexOf(a)>-1&&m.length>0;if(c){var g=j(t);h=g.newlinesToAppend+n,p+=g.newlinesToPrepend}if(m.startsWith(h)&&m.endsWith(p)){var E=m.slice(h.length,m.length-p.length);if(s===f){var S=s-h.length;S=Math.max(S,b),b=x=S=Math.min(S,b+E.length)}else x=b+E.length;return{text:E,selectionStart:b,selectionEnd:x}}if(v)return u.length>0&&m.match(u)?{text:h+(p=p.replace(a,m)),selectionStart:b=x=b+h.length,selectionEnd:x}:{text:h+m+p,selectionStart:b=b+h.length+m.length+p.indexOf(a),selectionEnd:x=b+a.length};var y=h+m+p;b=s+h.length,x=f+h.length;var O=m.match(/^\s*|\s*$/g);if(e.trimFirst&&O){var M=O[0]||"",C=O[1]||"";y=M+h+m.trim()+p+C,b+=M.length,x-=C.length}return{text:y,selectionStart:b,selectionEnd:x}},C=function(t,e){var n,r=t.value.slice(t.selectionStart,t.selectionEnd);n=e.orderedList?function(t){var e,n,r,o,i=/^\d+\.\s+/,a=t.selectionStart===t.selectionEnd,l=t.value.slice(t.selectionStart,t.selectionEnd),u=l,c=l.split("\n");if(a){var s=t.value.slice(0,t.selectionStart).split(/\n/);r=t.selectionStart-s[s.length-1].length,o=w(t.value,t.selectionStart,!0),u=t.value.slice(r,o)}var f=u.split("\n");if(f.every((function(t){return i.test(t)}))){if(l=(c=f.map((function(t){return t.replace(i,"")}))).join("\n"),a&&r&&o){var m=f[0].length-c[0].length;n=e=t.selectionStart-m,t.selectionStart=r,t.selectionEnd=o}}else{l=(c=function(){var t,e,n,r=[];for(n=t=0,e=c.length;t<e;n=++t){var o=c[n];r.push(n+1+". "+o)}return r}()).join("\n");var h=j(t),p=h.newlinesToAppend,d=h.newlinesToPrepend;e=(n=t.selectionStart+p.length)+l.length,a&&(n=e),l=p+l+d}return{text:l,selectionStart:n,selectionEnd:e}}(t):e.multiline&&R(r)?function(t,e){var n=e.prefix,r=e.suffix,o=e.surroundWithNewlines,i=t.value.slice(t.selectionStart,t.selectionEnd),a=t.selectionStart,l=t.selectionEnd,u=i.split("\n");if(u.every((function(t){return t.startsWith(n)&&t.endsWith(r)})))l=a+(i=u.map((function(t){return t.slice(n.length,t.length-r.length)})).join("\n")).length;else if(i=u.map((function(t){return n+t+r})).join("\n"),o){var c=j(t),s=c.newlinesToAppend,f=c.newlinesToPrepend;l=(a+=s.length)+i.length,i=s+i+f}return{text:i,selectionStart:a,selectionEnd:l}}(t,e):M(t,e),function(t,e){var n=e.text,r=e.selectionStart,o=e.selectionEnd,i=t.selectionStart,a=t.value.slice(0,i),l=t.value.slice(t.selectionEnd);if(null===y||!0===y){t.contentEditable="true";try{y=document.execCommand("insertText",!1,n)}catch(t){y=!1}t.contentEditable="false"}if(y&&!t.value.slice(0,t.selectionStart).endsWith(n)&&(y=!1),!y){try{document.execCommand("ms-beginUndoUnit")}catch(t){}t.value=a+n+l;try{document.execCommand("ms-endUndoUnit")}catch(t){}var u=document.createEvent("Event");u.initEvent("input",!0,!0),t.dispatchEvent(u)}null!=r&&null!=o?t.setSelectionRange(r,o):t.setSelectionRange(i,t.selectionEnd)}(t,n)},P=function(t,e){var n=S({},{prefix:"",suffix:"",blockPrefix:"",blockSuffix:"",multiline:!1,replaceNext:"",prefixSpace:!1,scanFor:"",surroundWithNewlines:!1,orderedList:!1,trimFirst:!1},e),r=t.element,o=t.textareaId,i=r.querySelector("#"+o);i&&(i.focus(),C(i,n))};var k=function(t){Object(s.a)(n,t);var e;e=n;function n(){return t.apply(this,arguments)||this}var r=n.prototype;return r.init=function(){this.textEditor=this.props.textEditor,this.localePrefix="the-turk-mathren.forum.textEditor.",this.mainBlockDelimiter=i.a.forum.attribute("mathRenMainBlockDelimiter"),this.mainInlineDelimiter=i.a.forum.attribute("mathRenMainInlineDelimiter")},r.view=function(){return p.a.component({className:"MathRenDropdown",buttonClassName:"Button Button--flat",label:E()("fas fa-square-root-alt"),children:this.items().toArray()})},r.items=function(){var t=this,e=new v.a;return e.add("mathBlock",b.a.component({icon:"fas fa-vector-square",children:i.a.translator.trans(this.localePrefix+"blockExpression"),onclick:function(){var e=t.mainBlockDelimiter.left,n=t.mainBlockDelimiter.right;P(t.textEditor,{prefix:e,suffix:n,multiline:!0})}}),50),e.add("mathInline",b.a.component({icon:"fas fa-grip-lines",children:i.a.translator.trans(this.localePrefix+"inlineExpression"),onclick:function(){var e=t.mainInlineDelimiter.left,n=t.mainInlineDelimiter.right;P(t.textEditor,{prefix:e,suffix:n,multiline:!0})}}),0),e},n}(m.a);i.a.initializers.add("the-turk-mathren",(function(){Object(r.extend)(l.a.prototype,"config",(function(){renderMathInElement($(".Post-body",this.element)[0],{ignoredTags:i.a.forum.attribute("mathRenIgnoredTags"),ignoredClasses:i.a.forum.attribute("mathRenIgnoredClasses"),fleqn:i.a.forum.attribute("mathRenEnableFleqn"),leqno:i.a.forum.attribute("mathRenEnableLeqno"),output:i.a.forum.attribute("mathRenOutputMode"),throwOnError:i.a.forum.attribute("mathRenEnableThrowOnError"),errorColor:i.a.forum.attribute("mathRenErrorColor"),minRuleThickness:i.a.forum.attribute("mathRenMinRuleThickness"),maxSize:i.a.forum.attribute("mathRenMaxSize"),maxExpand:i.a.forum.attribute("mathRenMaxExpand"),macros:JSON.parse(i.a.forum.attribute("mathRenMacros")),delimiters:i.a.forum.attribute("mathRenDelimiters"),colorIsTextColor:i.a.forum.attribute("mathRenEnableColorIsTextColor")})})),Object(r.override)(s9e.TextFormatter,"preview",(function(t,e,n){t(e,n),renderMathInElement(n,{ignoredTags:i.a.forum.attribute("mathRenIgnoredTags"),ignoredClasses:i.a.forum.attribute("mathRenIgnoredClasses"),fleqn:i.a.forum.attribute("mathRenEnableFleqn"),leqno:i.a.forum.attribute("mathRenEnableLeqno"),output:i.a.forum.attribute("mathRenOutputMode"),throwOnError:i.a.forum.attribute("mathRenEnableThrowOnError"),errorColor:i.a.forum.attribute("mathRenErrorColor"),minRuleThickness:i.a.forum.attribute("mathRenMinRuleThickness"),maxSize:i.a.forum.attribute("mathRenMaxSize"),maxExpand:i.a.forum.attribute("mathRenMaxExpand"),macros:JSON.parse(i.a.forum.attribute("mathRenMacros")),delimiters:i.a.forum.attribute("mathRenDelimiters"),colorIsTextColor:i.a.forum.attribute("mathRenEnableColorIsTextColor")})})),Object(r.extend)(c.a.prototype,"toolbarItems",(function(t){if(!0===i.a.forum.attribute("mathRenEnableTextEditorButtons")){var e=new k({textEditor:this});t.add("the-turk-mathren",e)}}))}))}]);
//# sourceMappingURL=forum.js.map